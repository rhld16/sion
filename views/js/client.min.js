var coin,players,rooms,canvas=document.getElementById("game"),ctx=canvas.getContext("2d"),keys=[];function gesize(){ctx.canvas.width=window.innerWidth,ctx.canvas.height=window.innerHeight}function drawPlayers(e){Object.keys(e).forEach(o=>{let t=e[o];ctx.fillStyle=t.colour,ctx.fillRect(t.x/5,t.y/5,playerSize/5,playerSize/5)})}function updateGameState(e){players=e.players,coins=e.coins,e.rooms&&(rooms=e.rooms),ctx.clearRect(0,0,canvas.width,canvas.height),ctx.beginPath(),ctx.arc((coins.x+coinSize/2)/5,(coins.y+coinSize/2)/5,coinSize/5,0,2*Math.PI,!1),ctx.fillStyle="gold",ctx.fill(),ctx.lineWidth=2,ctx.strokeStyle="#003300",ctx.stroke()}function gameLoop(){movePlayer(socket.id,keys),socket.emit("keys",keys),updateGameState({players:players,coins:coins}),Object.keys(players).forEach(e=>{let o=players[e];movePlayer(e,o.keys)})}function nameLoop(){var e="",o="";$("#userslist").empty(),Object.values(players).sort((e,o)=>o.score-e.score).forEach((o,t)=>e+=`<li><span style='border-bottom: 1px solid ${o.colour};'>${o.name}</span> - ${o.score}</li>`),$("#userslist").append(e),rooms&&($("#roomlist").empty(),rooms.forEach(function(e){o+=`<li onclick="changeRoom('${e}')" style="cursor: pointer;">${e}</li>`}),$("#roomlist").append(o))}function drawGame(){drawPlayers(players),requestAnimationFrame(drawGame)}gesize(),document.body.addEventListener("keydown",e=>keys[e.keyCode]=!0),document.body.addEventListener("keyup",e=>keys[e.keyCode]=!1),requestAnimationFrame(drawGame);